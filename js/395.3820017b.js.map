{"version":3,"file":"js/395.3820017b.js","mappings":"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","sources":["webpack://sus_front_celular_2/./src/views/TicketView.vue","webpack://sus_front_celular_2/./src/views/TicketView.vue?15e0"],"sourcesContent":["<template>\r\n  <main :class=\"cSalaDeEspera\">\r\n    <div class=\"TopPanel\">\r\n      <div class=\"TipoAtend\">\r\n        Tipo de atendimento: <label class=\"subTypeName\">{{ TypeAtend }}</label>\r\n      </div>\r\n      <div class=\"TipoAtend\">\r\n        Tipo de especialidade: <label class=\"subTypeName\">{{ sSelection }}</label>\r\n      </div>\r\n    </div>\r\n    <div class=\"Senha\">\r\n      <div class=\"senhaNumb\">\r\n        <label class=\"prefix\">{{ sPrefix }}</label>\r\n        <label class=\"sNumb\">{{ senha }}</label>\r\n      </div>\r\n      <div v-if=\"cSalaDeEspera === 'SalaDeEsperaAtiva'\" class=\"mensagemRecepcao\">\r\n        <div class=\"mensagemRecepcao2\">A sua vez chegou !</div>\r\n        <div class=\"mensagemRecepcao2\">Favor dirija-se ao balcão Nº {{ String(balcaoNumb).padStart(2, \"0\") }}</div>\r\n      </div>\r\n    </div>\r\n  </main>\r\n</template>\r\n\r\n<script>\r\n\r\nimport axios from 'axios'\r\n\r\nimport { io } from \"socket.io-client\";\r\n\r\n// const socket = io(\"http://localhost:3000\");\r\nconst socket = io(\"https://vizinhoapi.herokuapp.com/\");\r\n\r\nconst http = axios.create()\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      sPrefix: null,\r\n      sSelection: null,\r\n      cliente: null,\r\n      TypeAtend: null,\r\n      senha: 0,\r\n      BASE_URL: null,\r\n      cSalaDeEspera: \"SalaDeEspera\",\r\n      rConsult: null,\r\n      messageContainer: null,\r\n      ioclient: socket,\r\n      returnServerMsg: [],\r\n      balcaoNumb: null\r\n    }\r\n  },\r\n  beforeMount() {\r\n    this.verifySection()\r\n  },\r\n  mounted() {\r\n\r\n    this.BASE_URL = \"https://vizinhoapi.herokuapp.com/\"\r\n    // this.BASE_URL = \"http://localhost:3000/\"\r\n\r\n    this.sPrefix = localStorage.getItem('sPrefix')\r\n    this.sSelection = localStorage.getItem('sSelection')\r\n    try {\r\n      this.sSelection = JSON.parse(this.sSelection).name\r\n    } catch (error) {\r\n      this.sSelection = 'Pronto Atendimento'\r\n    }\r\n\r\n    this.cliente = localStorage.getItem('client')\r\n    this.cliente = JSON.parse(this.cliente)\r\n    this.switchCaseAtend()\r\n\r\n    this.verifyTriagem()\r\n\r\n    this.messageContainer = this.$refs.messageContainer;\r\n    this.socketConnection();\r\n    this.waitConnected();\r\n    this.waitChamada();\r\n    this.waitCancel();\r\n  },\r\n  methods: {\r\n    alertaCliente() {\r\n\r\n      this.cSalaDeEspera = \"SalaDeEsperaAtiva\"\r\n\r\n      var triagemSenha = `${this.sPrefix}${this.senha}`\r\n\r\n      if (Notification.permission === \"granted\") {\r\n        const notification = new Notification(\"SUS Notifications\", {\r\n          body: `${triagemSenha} Sua vez chegou, por favor, dirija-se ao balcão ${this.bLivre}`,\r\n          // Outras opções de configuração da notificação\r\n        });\r\n      }\r\n    },\r\n    verifySection() {\r\n\r\n      let section = localStorage.getItem('secction_page')\r\n\r\n      let lClient = localStorage.getItem('client')\r\n\r\n      // console.log({ section })\r\n      // console.log({ lClient })\r\n\r\n      if (lClient === null) {\r\n        localStorage.setItem('secction_page', 'home');\r\n        localStorage.setItem('sPrefix', null);\r\n        localStorage.setItem('sSelection', null);\r\n        this.$router.push('/');\r\n      }\r\n\r\n      if (section === null) {\r\n\r\n        localStorage.setItem('secction_page', 'home');\r\n        localStorage.setItem('sPrefix', null);\r\n        localStorage.setItem('sSelection', null);\r\n        localStorage.setItem('client', null);\r\n        this.$router.push('/');\r\n\r\n      }\r\n\r\n    },\r\n    zeroAdd(numero, quantidadeMinima) {\r\n      return String(numero).padStart(quantidadeMinima, '0');\r\n    },\r\n\r\n    async verifyTriagem() {\r\n\r\n      let lClient = this.cliente[0]\r\n\r\n      try {\r\n        const response = await http.post(this.BASE_URL + 'triagem/consult', {\r\n          client_id: lClient.idcliente\r\n        });\r\n\r\n        if (response.data.response.status) {\r\n          this.rConsult = response.data.response.triagem[0];\r\n          this.TypeAtend = this.rConsult.idespec;\r\n          this.sSelection = this.rConsult.idsubspec;\r\n          this.sPrefix = this.rConsult.espec_prefix;\r\n          this.senha = this.zeroAdd(this.rConsult.idtriagem, 3)\r\n          if (this.rConsult.cliente_chamado === 1) {\r\n            this.alertaCliente()\r\n          }\r\n        } else {\r\n          this.rConsult = null\r\n          this.senha = 0\r\n        }\r\n\r\n        // console.log(this.rConsult)\r\n\r\n      } catch (error) {\r\n\r\n        // console.log({ error });\r\n\r\n      }\r\n\r\n    },\r\n    switchCaseAtend() {\r\n      switch (this.sPrefix) {\r\n        case 'A':\r\n          this.TypeAtend = 'Acolhimento'\r\n          break;\r\n        case 'S':\r\n          this.TypeAtend = 'Área assistencial'\r\n          break;\r\n        case 'D':\r\n          this.TypeAtend = 'Serviço de apoio à diagnose e terapia'\r\n          break;\r\n        case 'B':\r\n          this.TypeAtend = 'Atenção Básica'\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    },\r\n    waitConnected() {\r\n      this.ioclient.on(\"connected\", (mensagem) => {\r\n        this.returnServerMsg.push(mensagem);\r\n        this.getRooms();\r\n        this.getClients();\r\n        this.sendJoin(1, \"Sala de Espera\");\r\n      });\r\n    },\r\n    waitChamada() {\r\n      this.ioclient.on(\"send_ClientAlert\", (mensagem) => {\r\n        let msgRecept = mensagem.data[0]\r\n        this.balcaoNumb = msgRecept.balcao\r\n        let lCliente = this.cliente\r\n        lCliente = lCliente[0].idcliente\r\n        // console.log({ lCliente })\r\n        if (lCliente === msgRecept.id) {\r\n          this.alertaCliente()\r\n        } else {\r\n          this.cSalaDeEspera = 'SalaDeEspera'\r\n        }\r\n      });\r\n    },\r\n    waitCancel() {\r\n\r\n      this.ioclient.on(\"send_ClientCancel\", (mensagem) => {\r\n                \r\n        let sCliente = mensagem\r\n\r\n        let lCliente = this.cliente[0].idcliente\r\n        \r\n        if (lCliente === sCliente) {\r\n          this.$router.push('/')\r\n        }\r\n\r\n      });\r\n\r\n    },\r\n    getClients() {\r\n      // socket.emit('get_clients');\r\n\r\n      this.ioclient.on(\"clients_list\", (clients) => {\r\n        // console.log(\"Connected clients:\", clients);\r\n        this.pacientes = clients\r\n      });\r\n    },\r\n    getRooms() {\r\n\r\n      this.ioclient.on(\"rooms_list\", (list) => {\r\n        // console.log(\"Rooms:\", list);\r\n        this.salas = list\r\n      });\r\n\r\n    },\r\n    rolarScroll() {\r\n      // setTimeout(() => {\r\n      //   const messageContainer = this.$refs.messageContainer;\r\n      //   messageContainer.scrollTop = messageContainer.scrollHeight;\r\n      // }, 0);\r\n    },\r\n    socketConnection() {\r\n      this.ioclient.on(\"send_message\", (mensagem) => {\r\n        this.returnServerMsg.push(mensagem);\r\n        this.rolarScroll();\r\n      });\r\n    },\r\n    sendJoin(userId, room) {\r\n      // Evento para se juntar a uma sala\r\n      this.ioclient.emit(\"join\", { userId, room });      \r\n    },\r\n    sendText() {\r\n      this.ioclient.emit(\"send_message\", { name: \"usuário\", message: this.messageText });\r\n      this.messageText = null;\r\n    },\r\n    sendHello() {\r\n      this.ioclient.emit(\"send_message\", { name: \"usuário\", message: \"Olá, servidor!\" });\r\n      this.ioclient.emit(\"send_message\", { name: \"usuário\", message: \"Olá, sala!\" });\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.SalaDeEspera {\r\n  height: 100%;\r\n}\r\n\r\n.SalaDeEsperaAtiva {\r\n  height: 100%;\r\n  background-color: rgb(10, 6, 27);\r\n}\r\n\r\n.TopPanel {\r\n  min-height: 90px;\r\n  padding: 8px;\r\n  padding-left: 12px;\r\n  padding-bottom: 24px;\r\n  border-bottom: solid 1px #d5e7ff67;\r\n  margin: 8px;\r\n  margin-left: 16px;\r\n  margin-right: 16px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  font-size: 1rem;\r\n}\r\n\r\n.TipoAtend {\r\n  font-weight: 900;\r\n  color: rgba(240, 248, 255, 0.39);\r\n}\r\n\r\n.subTypeName {\r\n  font-weight: 700;\r\n  color: aliceblue;\r\n}\r\n\r\n.Senha {\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  font-size: 7rem;\r\n  height: 100%;\r\n}\r\n\r\n.mensagemRecepcao {\r\n  height: 160px;\r\n  width: 80%;\r\n  font-size: 2rem;\r\n  background-color: aliceblue;\r\n  color: rgb(2, 2, 32);\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  border-radius: 12px;\r\n  box-shadow: 4px 4px 4px #b3c1ff8a;\r\n  text-align: center;  \r\n}\r\n\r\n.mensagemRecepcao div {\r\n  font-weight: 800;\r\n  font-size: 1.6rem;\r\n}\r\n\r\n.senhaNumb {\r\n  margin-top: -120px;\r\n}\r\n\r\n.sNumb,\r\n.prefix {\r\n  font-weight: 700;\r\n  font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;\r\n}\r\n\r\n.prefix {\r\n  color: rgb(39, 39, 156);\r\n}\r\n\r\n.sNumb {\r\n  color: aliceblue;\r\n}\r\n</style>\r\n","import { render } from \"./TicketView.vue?vue&type=template&id=35bda5d4&scoped=true\"\nimport script from \"./TicketView.vue?vue&type=script&lang=js\"\nexport * from \"./TicketView.vue?vue&type=script&lang=js\"\n\nimport \"./TicketView.vue?vue&type=style&index=0&id=35bda5d4&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\Pedro\\\\Projetos\\\\SUS\\\\sus_front_celular_2\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-35bda5d4\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createElementBlock","_normalizeClass","$data","cSalaDeEspera","_hoisted_1","_hoisted_2","_hoisted_3","_toDisplayString","TypeAtend","_hoisted_4","_hoisted_5","sSelection","_hoisted_6","_hoisted_7","_hoisted_8","sPrefix","_hoisted_9","senha","_hoisted_10","_hoisted_11","_hoisted_12","String","balcaoNumb","padStart","socket","io","http","axios","data","cliente","BASE_URL","rConsult","messageContainer","ioclient","returnServerMsg","beforeMount","this","verifySection","mounted","localStorage","getItem","JSON","parse","name","error","switchCaseAtend","verifyTriagem","$refs","socketConnection","waitConnected","waitChamada","waitCancel","methods","alertaCliente","triagemSenha","Notification","permission","body","bLivre","section","lClient","setItem","$router","push","zeroAdd","numero","quantidadeMinima","async","response","post","client_id","idcliente","status","triagem","idespec","idsubspec","espec_prefix","idtriagem","cliente_chamado","on","mensagem","getRooms","getClients","sendJoin","msgRecept","balcao","lCliente","id","sCliente","clients","pacientes","list","salas","rolarScroll","userId","room","emit","sendText","message","messageText","sendHello","__exports__","render"],"sourceRoot":""}